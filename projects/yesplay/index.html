<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>

    <link rel="stylesheet" href="./css/style2.css?16">
</head>

<body>
    <main>
        <div class="wrapper" id="confeti">
            <div class="confetti-149"></div>
            <div class="confetti-148"></div>
            <div class="confetti-147"></div>
            <div class="confetti-146"></div>
            <div class="confetti-145"></div>
            <div class="confetti-144"></div>
            <div class="confetti-143"></div>
            <div class="confetti-142"></div>
            <div class="confetti-141"></div>
            <div class="confetti-140"></div>
            <div class="confetti-139"></div>
            <div class="confetti-138"></div>
            <div class="confetti-137"></div>
            <div class="confetti-136"></div>
            <div class="confetti-135"></div>
            <div class="confetti-134"></div>
            <div class="confetti-133"></div>
            <div class="confetti-132"></div>
            <div class="confetti-131"></div>
            <div class="confetti-130"></div>
            <div class="confetti-129"></div>
            <div class="confetti-128"></div>
            <div class="confetti-127"></div>
            <div class="confetti-126"></div>
            <div class="confetti-125"></div>
            <div class="confetti-124"></div>
            <div class="confetti-123"></div>
            <div class="confetti-122"></div>
            <div class="confetti-121"></div>
            <div class="confetti-120"></div>
            <div class="confetti-119"></div>
            <div class="confetti-118"></div>
            <div class="confetti-117"></div>
            <div class="confetti-116"></div>
            <div class="confetti-115"></div>
            <div class="confetti-114"></div>
            <div class="confetti-113"></div>
            <div class="confetti-112"></div>
            <div class="confetti-111"></div>
            <div class="confetti-110"></div>
            <div class="confetti-109"></div>
            <div class="confetti-108"></div>
            <div class="confetti-107"></div>
            <div class="confetti-106"></div>
            <div class="confetti-105"></div>
            <div class="confetti-104"></div>
            <div class="confetti-103"></div>
            <div class="confetti-102"></div>
            <div class="confetti-101"></div>
            <div class="confetti-100"></div>
            <div class="confetti-99"></div>
            <div class="confetti-98"></div>
            <div class="confetti-97"></div>
            <div class="confetti-96"></div>
            <div class="confetti-95"></div>
            <div class="confetti-94"></div>
            <div class="confetti-93"></div>
            <div class="confetti-92"></div>
            <div class="confetti-91"></div>
            <div class="confetti-90"></div>
            <div class="confetti-89"></div>
            <div class="confetti-88"></div>
            <div class="confetti-87"></div>
            <div class="confetti-86"></div>
            <div class="confetti-85"></div>
            <div class="confetti-84"></div>
            <div class="confetti-83"></div>
            <div class="confetti-82"></div>
            <div class="confetti-81"></div>
            <div class="confetti-80"></div>
            <div class="confetti-79"></div>
            <div class="confetti-78"></div>
            <div class="confetti-77"></div>
            <div class="confetti-76"></div>
            <div class="confetti-75"></div>
            <div class="confetti-74"></div>
            <div class="confetti-73"></div>
            <div class="confetti-72"></div>
            <div class="confetti-71"></div>
            <div class="confetti-70"></div>
            <div class="confetti-69"></div>
            <div class="confetti-68"></div>
            <div class="confetti-67"></div>
            <div class="confetti-66"></div>
            <div class="confetti-65"></div>
            <div class="confetti-64"></div>
            <div class="confetti-63"></div>
            <div class="confetti-62"></div>
            <div class="confetti-61"></div>
            <div class="confetti-60"></div>
            <div class="confetti-59"></div>
            <div class="confetti-58"></div>
            <div class="confetti-57"></div>
            <div class="confetti-56"></div>
            <div class="confetti-55"></div>
            <div class="confetti-54"></div>
            <div class="confetti-53"></div>
            <div class="confetti-52"></div>
            <div class="confetti-51"></div>
            <div class="confetti-50"></div>
            <div class="confetti-49"></div>
            <div class="confetti-48"></div>
            <div class="confetti-47"></div>
            <div class="confetti-46"></div>
            <div class="confetti-45"></div>
            <div class="confetti-44"></div>
            <div class="confetti-43"></div>
            <div class="confetti-42"></div>
            <div class="confetti-41"></div>
            <div class="confetti-40"></div>
            <div class="confetti-39"></div>
            <div class="confetti-38"></div>
            <div class="confetti-37"></div>
            <div class="confetti-36"></div>
            <div class="confetti-35"></div>
            <div class="confetti-34"></div>
            <div class="confetti-33"></div>
            <div class="confetti-32"></div>
            <div class="confetti-31"></div>
            <div class="confetti-30"></div>
            <div class="confetti-29"></div>
            <div class="confetti-28"></div>
            <div class="confetti-27"></div>
            <div class="confetti-26"></div>
            <div class="confetti-25"></div>
            <div class="confetti-24"></div>
            <div class="confetti-23"></div>
            <div class="confetti-22"></div>
            <div class="confetti-21"></div>
            <div class="confetti-20"></div>
            <div class="confetti-19"></div>
            <div class="confetti-18"></div>
            <div class="confetti-17"></div>
            <div class="confetti-16"></div>
            <div class="confetti-15"></div>
            <div class="confetti-14"></div>
            <div class="confetti-13"></div>
            <div class="confetti-12"></div>
            <div class="confetti-11"></div>
            <div class="confetti-10"></div>
            <div class="confetti-9"></div>
            <div class="confetti-8"></div>
            <div class="confetti-7"></div>
            <div class="confetti-6"></div>
            <div class="confetti-5"></div>
            <div class="confetti-4"></div>
            <div class="confetti-3"></div>
            <div class="confetti-2"></div>
            <div class="confetti-1"></div>
            <div class="confetti-0"></div>
        </div>
        <div class="container">
            <div class="content">
                <img src="img/logo-2.svg" class="logo" alt="logo">
                <h1>
                    press start button <br> and try your luck
                </h1>
                <button class="btn" id="spin_btn">start</button>
            </div>
            <div class="left">
                <div class="girl">
                    <img src="img/girl.svg" alt="girl">
                </div>
                <div class="spin-container">
                    <div class="spin-middle"><span class="spin-middle__light anim"></span></div>
                    <div class="spinflapper"></div>
                    <span class="spinit-light"></span>
                    <div class="spinit" id="spinit">
                    </div>
                </div>
                <button class="ball" id="btnBall">1</button>
            </div>
        </div>
    </main>

    <div class="modal" id="modal_partners">
        <div class="modal-content">
            <div class="inp-wrap"><input type="radio" checked name="affiliate" value="https://yesplay.club/3KKLYNR"
                    id="partner-1"><label for="partner-1">Mpower-1</label></div>
            <div class="inp-wrap"><input type="radio" name="affiliate" value="https://yesplay.club/3vkSJiP"
                    id="partner-2"><label for="partner-2">Mpower-2</label></div>
            <div class="inp-wrap"><input type="radio" name="affiliate" value="https://yesplay.club/3rpgMMu"
                    id="partner-3"><label for="partner-3">Mpower-3</label></div>
            <div class="inp-wrap"><input type="radio" name="affiliate" value="https://yesplay.club/3EhbyYn"
                    id="partner-4"><label for="partner-4">Mpower-4</label></div>
            <div class="inp-wrap"><input type="radio" name="affiliate" value="https://yesplay.club/3rqUaeG"
                    id="partner-5"><label for="partner-5">Mpower-5</label></div>
            <div class="inp-wrap"><input type="radio" name="affiliate" value="https://yesplay.club/3KGOch7"
                    id="partner-6"><label for="partner-6">Mpower-6</label></div>
            <div class="inp-wrap"><input type="radio" name="affiliate" value="https://yesplay.club/3xpI49t"
                    id="partner-7"><label for="partner-7">Mpower-7</label></div>
            <div class="inp-wrap"><input type="radio" name="affiliate" value="https://yesplay.club/3uG7LAR"
                    id="partner-8"><label for="partner-8">Mpower-8</label></div>
            <div class="inp-wrap"><input type="radio" name="affiliate" value="https://yesplay.club/3JIjBPd"
                    id="partner-9"><label for="partner-9">Mpower-9</label></div>
            <div class="inp-wrap"><input type="radio" name="affiliate" value="https://yesplay.club/3xtUVr8"
                    id="partner-10"><label for="partner-10">Mpower-10</label></div>
        </div>
    </div>

    <div class="modal" id="modal">
        <div class="modal-content">
            <button class="modal-close" id="modal-close">&#10006;</button>
            <img src="img/logo.png" alt="logo">
            <p>You win 100% deposit bonus!<br><span>Enter your mobile to receive the bonus</span></p>
            <p><input type="tel" inputmode="decimal" alias="numeric" autocomplete="off" class="input" id="phone"
                    placeholder="0 --_ ---_---- " value="0 " /></p>
            <button class="btn" id="getit_btn">Receive bonus</button>
        </div>
    </div>

    <div class="modal small" id="modal_re">
        <div class="modal-content">
            <img src="img/logo.png" alt="logo">
            <div class="table"><button class="btn" id="resend_btn">Send again</button><button class="btn"
                    id="close_btn">Close</button></div>
        </div>
    </div>

    <audio id="audioWheel" preload src="js/wheel_2.mp3"></audio>
    <audio id="audioWin" preload src="js/win_2.mp3"></audio>
    <script src="./js/inputmask.min.js"></script>

    <script>
        const mClose = document.getElementById('modal-close'),
            spin = document.getElementById('spinit'),
            btnBall = document.getElementById('btnBall'),
            spinBtn = document.getElementById('spin_btn'),
            modal = document.getElementById('modal'),
            modalPartners = document.getElementById('modal_partners'),
            modalRe = document.getElementById('modal_re'),
            confeti = document.getElementById('confeti'),
            phone = document.getElementById("phone"),
            getit = document.getElementById("getit_btn"),
            resendBtn = document.getElementById('resend_btn'),
            closeBtn = document.getElementById('close_btn'),
            audioWin = document.getElementById('audioWin'),
            audioWheel = document.getElementById('audioWheel'),
            btnLabel = document.querySelectorAll('#modal_partners label');

        if (document.cookie) {
            document.querySelector("input[type=radio]:checked").removeAttribute('checked');
            document.getElementById(getCookie('partner')).setAttribute('checked', 'checked');
            btnBall.innerText = getCookie('text');
        }

        modal.style.display = 'block';
        modalRe.style.display = 'block';

        let im = new Inputmask("9 99-999-9999", {
            "oncomplete": () => { getit.removeAttribute('disabled'); },
            "onincomplete": () => { getit.setAttribute("disabled", "disabled"); },
            'autoUnmask': true
        }); im.mask(phone);

        btnBall.addEventListener('click', () => {
            modalPartners.classList.add('active');
        });

        for (let a = 0; a < btnLabel.length; a++) {
            btnLabel[a].onclick = () => {
                setCookie("partner", btnLabel[a].getAttribute('for'), 30);
                setCookie("text", a + 1, 30);
                btnBall.innerText = a + 1;
                setTimeout(() => {
                    modalPartners.classList.remove('active');
                }, 100);
            }
        };

        function getCookie(cname) {
            let name = cname + "=";
            let decodedCookie = decodeURIComponent(document.cookie);
            let ca = decodedCookie.split(';');
            for (let i = 0; i < ca.length; i++) {
                let c = ca[i];
                while (c.charAt(0) == ' ') {
                    c = c.substring(1);
                }
                if (c.indexOf(name) == 0) {
                    return c.substring(name.length, c.length);
                }
            }
            return "";
        }

        function setCookie(cname, cvalue, exdays) {
            const d = new Date();
            d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));
            let expires = "expires=" + d.toUTCString();
            document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
        }

        getit.addEventListener('click', () => {
            const inpPartner = document.querySelector('input[type="radio"]:checked');
            let answer = callAjax('./sender.php', "phone=" + phone.value + "&partner=" + inpPartner.value);
            modal.classList.remove('active');
            modalRe.classList.add('active');
        });

        resendBtn.addEventListener('click', () => {
            modalRe.classList.remove('active');
            modal.classList.add('active');
        });

        closeBtn.addEventListener('click', () => {
            location.reload();
        });

        spinBtn.addEventListener('click', () => {
            game()
        });

        function callAjax(url, data) {
            var xmlhttp;
            xmlhttp = new XMLHttpRequest();
            xmlhttp.onreadystatechange = () => {
                if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                    console.log(xmlhttp.response);
                    //return xmlhttp.response;
                }
            }
            xmlhttp.open("POST", url, false);
            xmlhttp.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
            xmlhttp.send(data)
        }

        function game() {
            let random = Math.floor(Math.random() * 100) + 1;

            audioWheel.play()
            spinBtn.setAttribute("disabled", "disabled")

            if ((spin.classList.contains('first')) && (!spin.classList.contains('second'))) {
                if (random < 60) {
                    win();
                } else spin.classList.add('second');
            } else if (spin.classList.contains('second')) {
                win();
            } else {
                spin.classList.add('first');
                if (random < 30) {
                    win();
                }
            }
            setTimeout(() => {
                spinBtn.removeAttribute('disabled')
            }, 4500);
        }

        mClose.addEventListener('click', () => {
            modal.classList.remove('active');
            location.reload();
        })

        function win() {
            spin.classList.add('win');
            setTimeout(() => {
                confeti.classList.add('active');
                spinBtn.removeAttribute('disabled')
                audioWin.play();
            }, 4000);
            setTimeout(() => {
                modal.classList.add('active');
                getit.setAttribute("disabled", "disabled");
                phone.focus();
            }, 6200);
        }
    </script>

</body>

</html>